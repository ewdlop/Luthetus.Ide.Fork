\doxysection{Throttle\+Event\+Queue\+Async.\+cs}
\hypertarget{_throttle_event_queue_async_8cs_source}{}\label{_throttle_event_queue_async_8cs_source}\index{Source/Lib/Common/Reactives/Models/ThrottleEventQueueAsync.cs@{Source/Lib/Common/Reactives/Models/ThrottleEventQueueAsync.cs}}
\mbox{\hyperlink{_throttle_event_queue_async_8cs}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00001}00001\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_luthetus_1_1_common_1_1_razor_lib_1_1_background_tasks_1_1_models}{Luthetus.Common.RazorLib.BackgroundTasks.Models}};}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00002}00002\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_luthetus_1_1_common_1_1_razor_lib_1_1_exceptions}{Luthetus.Common.RazorLib.Exceptions}};}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00003}00003\ \textcolor{keyword}{using\ }System.Collections.Immutable;}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00004}00004\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00005}00005\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models}{Luthetus.Common.RazorLib.Reactives.Models}};}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00006}00006\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00010}\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async}{00010}}\ \textcolor{keyword}{public}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async}{ThrottleEventQueueAsync}}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00011}00011\ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00019}00019\ \ \ \ \ \textcolor{keyword}{private}\ readonly\ LinkedList<IBackgroundTask>\ \_queue\ =\ \textcolor{keyword}{new}();}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00023}00023\ \ \ \ \ \textcolor{keyword}{private}\ readonly\ SemaphoreSlim\ \_dequeueSemaphoreSlim\ =\ \textcolor{keyword}{new}(0);}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00027}00027\ \ \ \ \ \textcolor{keyword}{private}\ readonly\ SemaphoreSlim\ \_modifyQueueSemaphoreSlim\ =\ \textcolor{keyword}{new}(1,\ 1);}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00029}\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_af84a28f244c74fdc2a039063702327f8}{00029}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_af84a28f244c74fdc2a039063702327f8}{IsStoppingFurtherEnqueues}}\ \{\ \textcolor{keyword}{get};\ \textcolor{keyword}{private}\ \textcolor{keyword}{set};\ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00034}\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_a1e9fb50316818930ce2e364d3ad9f865}{00034}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_a1e9fb50316818930ce2e364d3ad9f865}{Count}}\ =>\ \_queue.Count;}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00035}00035\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00036}\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_a1a431e4252754457b13e82d1bae10472}{00036}}\ \ \ \ \ \textcolor{keyword}{public}\ ImmutableArray<IBackgroundTask>\ \mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_a1a431e4252754457b13e82d1bae10472}{ThrottleEventList}}\ =>\ \_queue.ToImmutableArray();}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00052}\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_af0406fd8ea7dd2d9c9a3f255588ead75}{00052}}\ \ \ \ \ \textcolor{keyword}{public}\ async\ Task\ \mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_af0406fd8ea7dd2d9c9a3f255588ead75}{EnqueueAsync}}(\mbox{\hyperlink{interface_luthetus_1_1_common_1_1_razor_lib_1_1_background_tasks_1_1_models_1_1_i_background_task}{IBackgroundTask}}\ downstreamEvent)}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00053}00053\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00054}00054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_af84a28f244c74fdc2a039063702327f8}{IsStoppingFurtherEnqueues}})}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_exceptions_1_1_luthetus_common_exception}{LuthetusCommonException}}(\$\textcolor{stringliteral}{"{}Cannot\ enqueue\ on\ a\ stopped\ \{nameof(ThrottleEventQueueAsync)\}"{}});}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00056}00056\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00057}00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00058}00058\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ await\ \_modifyQueueSemaphoreSlim.WaitAsync().ConfigureAwait(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00061}00061\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ This\ looks\ very\ incorrect.\ (2025-\/05-\/27)}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ============================================}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00063}00063\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Why\ am\ I\ looping\ through\ the\ '\_queue',}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00064}00064\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ as\ opposed\ to\ just\ batching\ with\ the\ most\ recently}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00065}00065\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ enqueued\ thing\ prior\ to\ "{}me"{}?}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00066}00066\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ There\ is\ likely\ a\ lot\ of\ shifting\ within\ the\ '\_queue',}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ when\ tasks\ are\ enqueued/dequeued.}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Perhaps\ a\ different\ datastructure\ would\ be\ preferred?}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Is\ a\ linked\ list\ a\ good\ idea\ here?}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ OnKeyDown\ events\ have\ a\ special\ issue,}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ in\ that\ they're\ not\ batchable\ until\ the\ time\ of\ their\ dequeueing,}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ because\ the\ command\ that\ is\ invoked\ as\ a\ result\ of\ an\ OnKeyDown\ event}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ is\ dependent\ on\ what\ layer\ the\ keymap\ is\ in.}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ That\ being\ that,\ one\ can\ still\ batch\ all\ OnKeyDown\ events\ together}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ without\ the\ intent\ of\ performing\ an\ optimized\ calculation,\ but\ instead}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ a\ foreach-\/loop-\/batching.}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ During\ the\ foreach-\/loop-\/batching,\ you\ can\ still\ try\ to\ optimize\ calculations}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ where\ consecutive\ OnKeyDown\ events\ can\ be\ combined\ as\ well.}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ But,\ this\ way\ you'd\ avoid\ any\ of\ the\ 'TentativeKeyboardEventArgsKind'}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ confusion.}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_queue.Count\ >\ 0)}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ upstreamEvent\ =\ \_queue.Last.Value;}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ Rename\ 'BatchOrDefault'\ to\ 'TryMergeIntoUpstream'}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00090}00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ batchEvent\ =\ downstreamEvent.\mbox{\hyperlink{interface_luthetus_1_1_common_1_1_razor_lib_1_1_background_tasks_1_1_models_1_1_i_background_task_a1297b3be631c1bb2c38c132674f61911}{BatchOrDefault}}(upstreamEvent);}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (batchEvent\ is\ not\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00093}00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ length\ of\ the\ queue\ has\ not\ changed,}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ so\ do\ not\ release\ the\ dequeue\ semaphore\ here.}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00096}00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00097}00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ batching\ was\ successful\ so\ return\ early.}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00098}00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_queue.RemoveLast();}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00099}00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_queue.AddLast(batchEvent);}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ batching\ was\ NOT\ successful\ so\ add\ to\ the\ queue.}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \_queue.AddLast(downstreamEvent);}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \_dequeueSemaphoreSlim.Release();}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00107}00107\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00108}00108\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{finally}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00109}00109\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ \_modifyQueueSemaphoreSlim.Release();}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00111}00111\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00112}00112\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00113}00113\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00117}\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_ad16053388e4858f8a083cf6619dcdace}{00117}}\ \ \ \ \ \textcolor{keyword}{public}\ async\ Task<IBackgroundTask>\ \mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_ad16053388e4858f8a083cf6619dcdace}{DequeueOrDefaultAsync}}()}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00118}00118\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00119}00119\ \ \ \ \ \ \ \ \ await\ \_dequeueSemaphoreSlim.WaitAsync().ConfigureAwait(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00120}00120\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00121}00121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00122}00122\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ await\ \_modifyQueueSemaphoreSlim.WaitAsync().ConfigureAwait(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00125}00125\ \ \ \ \ \ \ \ \ \ \ \ \ var\ task\ =\ \_queue.First.Value;}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00126}00126\ \ \ \ \ \ \ \ \ \ \ \ \ \_queue.RemoveFirst();}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ task;}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00128}00128\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00129}00129\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (ArgumentOutOfRangeException\ e)}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00130}00130\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00132}00132\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ Got\ exception\ on\ (2024-\/05-\/08):}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00133}00133\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ ===========================================================}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00134}00134\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ System.ArgumentOutOfRangeException:\ Index\ was\ out\ of\ range.\ Must\ be\ non-\/negative\ and\ less\ than\ the\ size\ of\ the\ collection.\ (Parameter\ 'index')}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00135}00135\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ at\ System.Collections.Generic.List`1.get\_Item(Int32\ index)}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00136}00136\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ at\ Luthetus.Common.RazorLib.Reactives.Models.ThrottleEventQueueAsync.DequeueOrDefaultAsync()\ in\ C:\(\backslash\)Users\(\backslash\)hunte\(\backslash\)Repos\(\backslash\)Luthetus.Ide\_Fork\(\backslash\)Source\(\backslash\)Lib\(\backslash\)Common\(\backslash\)Reactives\(\backslash\)Models\(\backslash\)ThrottleEventQueueAsync.cs:line\ 97}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00137}00137\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ at\ Luthetus.Common.RazorLib.BackgroundTasks.Models.BackgroundTaskWorker.ExecuteAsync(CancellationToken\ cancellationToken)\ in\ C:\(\backslash\)Users\(\backslash\)hunte\(\backslash\)Repos\(\backslash\)Luthetus.Ide\_Fork\(\backslash\)Source\(\backslash\)Lib\(\backslash\)Common\(\backslash\)BackgroundTasks\(\backslash\)Models\(\backslash\)BackgroundTaskWorker.cs:line\ 31}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00138}00138\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ at\ Microsoft.Extensions.Hosting.Internal.Host.TryExecuteBackgroundServiceAsync(BackgroundService\ backgroundService)}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00139}00139\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00140}00140\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00142}00142\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ I'm\ going\ to\ eat\ this\ exception\ for\ a\ moment.}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00143}00143\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ I\ can't\ test\ scrolling\ logic\ cause\ this\ exception\ keeps\ happening\ (2024-\/05-\/09).}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00144}00144\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Console.WriteLine(e.ToString());}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00147}00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_background_tasks_1_1_models_1_1_background_task}{BackgroundTask}}(}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00148}00148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespace_luthetus_1_1_common_1_1_razor_lib_1_1_keys}{Keys}}.\mbox{\hyperlink{namespace_luthetus_1_1_common_1_1_razor_lib_1_1_keys_1_1_models}{Models}}.Key<\mbox{\hyperlink{interface_luthetus_1_1_common_1_1_razor_lib_1_1_background_tasks_1_1_models_1_1_i_background_task}{IBackgroundTask}}>.NewKey(),}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00149}00149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_background_tasks_1_1_models_1_1_continuous_background_task_worker}{ContinuousBackgroundTaskWorker}}.\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_background_tasks_1_1_models_1_1_continuous_background_task_worker_a2bbecf18336413ee1caff9d378acc256}{GetQueueKey}}(),}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00150}00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}I'm\ going\ to\ eat\ this\ exception\ for\ a\ moment."{}},}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00151}00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ()\ =>\ Task.CompletedTask);}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00152}00152\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00153}00153\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00154}00154\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ throw;}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00155}00155\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00156}00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{finally}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00157}00157\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ \_modifyQueueSemaphoreSlim.Release();}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00159}00159\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00160}00160\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00161}00161\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00162}\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_a9080c44a0d47eb00c63d893448e0daa6}{00162}}\ \ \ \ \ \textcolor{keyword}{public}\ async\ Task\ \mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_a9080c44a0d47eb00c63d893448e0daa6}{StopFurtherEnqueuesAsync}}()}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00163}00163\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00164}00164\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00165}00165\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ await\ \_modifyQueueSemaphoreSlim.WaitAsync().ConfigureAwait(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_af84a28f244c74fdc2a039063702327f8}{IsStoppingFurtherEnqueues}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00168}00168\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00169}00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{finally}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00170}00170\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00171}00171\ \ \ \ \ \ \ \ \ \ \ \ \ \_modifyQueueSemaphoreSlim.Release();}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00172}00172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00173}00173\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00174}00174\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00183}\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_a9c18aeecddeaca7a66fac33f13a58ff5}{00183}}\ \ \ \ \ \textcolor{keyword}{public}\ async\ Task\ \mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_a9c18aeecddeaca7a66fac33f13a58ff5}{UntilIsEmptyAsync}}(}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00184}00184\ \ \ \ \ \ \ \ \ TimeSpan?\ pollingTimeSpan\ =\ \textcolor{keyword}{null},}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00185}00185\ \ \ \ \ \ \ \ \ CancellationToken\ cancellationToken\ =\ \textcolor{keywordflow}{default})}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00186}00186\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00187}00187\ \ \ \ \ \ \ \ \ pollingTimeSpan\ ??=\ TimeSpan.FromMilliseconds(333);}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00188}00188\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00189}00189\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (!cancellationToken.IsCancellationRequested)}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00190}00190\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00191}00191\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_luthetus_1_1_common_1_1_razor_lib_1_1_reactives_1_1_models_1_1_throttle_event_queue_async_a1e9fb50316818930ce2e364d3ad9f865}{Count}}\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00192}00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00193}00193\ }
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \ \ \ await\ Task.Delay(pollingTimeSpan.Value).ConfigureAwait(\textcolor{keyword}{false});}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00195}00195\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00196}00196\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_throttle_event_queue_async_8cs_source_l00197}00197\ \}}

\end{DoxyCode}
